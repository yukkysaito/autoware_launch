<launch>
  <arg name="input_route_topic_name" default="/planning/mission_planning/route" />
  <arg name="map_topic_name" default="/map/vector_map" />

  <node pkg="lane_change_planner" exec="lane_change_planner" name="lane_change_planner" output="screen">
    <param name="use_sim_time" value="$(env AW_ROS2_USE_SIM_TIME false)"/>
    <remap from="~/input/route" to="$(var input_route_topic_name)" />
    <remap from="~/input/vector_map" to="$(var map_topic_name)" />
    <remap from="~/input/perception" to="/perception/object_recognition/objects" />
    <remap from="~/input/velocity" to="/localization/twist" />
    <remap from="~/input/lane_change_approval" to="/planning/scenario_planning/lane_driving/lane_change_approval" />
    <remap from="~/input/force_lane_change" to="/planning/scenario_planning/lane_driving/force_lane_change" />
    <remap from="~/output/lane_change_path" to="path_with_lane_id" />
    <remap from="~/output/lane_change_ready" to="/planning/scenario_planning/lane_driving/lane_change_ready" />
    <remap from="~/output/lane_change_available" to="/planning/scenario_planning/lane_driving/lane_change_available" />
    <remap from="~/output/stop_reasons" to="/planning/scenario_planning/status/stop_reasons" />
    <remap from="~/debug/lane_change_candidate_path" to="/planning/scenario_planning/lane_driving/lane_change_candidate_path" />
    <param from="$(find-pkg-share planning_launch)/config/scenario_planning/lane_driving/behavior_planning/lane_change_planner/lane_change_planner.param.yaml" />
    <param name="enable_abort_lane_change" value="false" />
    <param name="enable_collision_check_at_prepare_phase" value="false" />
    <param name="use_predicted_path_outside_lanelet" value="false" />
    <param name="use_all_predicted_path" value="false" />
    <param name="enable_blocked_by_obstacle" value="false" />
  </node>

  <executable cmd="ros2 topic pub /planning/scenario_planning/lane_driving/lane_change_approval
                   autoware_planning_msgs/msg/LaneChangeCommand 'command: true' -r 10"/>

  <node pkg="turn_signal_decider" exec="turn_signal_decider" name="turn_signal_decider" output="screen">
    <param name="use_sim_time" value="$(env AW_ROS2_USE_SIM_TIME false)" />
    <remap from="input/path_with_lane_id" to="path_with_lane_id" />
    <remap from="input/vector_map" to="$(var map_topic_name)" />
    <remap from="output/turn_signal_cmd" to="/planning/turn_signal_decider/turn_signal_cmd" />
    <param name="lane_change_search_distance" value="30.0" />
    <param name="intersection_search_distance" value="15.0" />
  </node>

  <include file="$(find-pkg-share behavior_velocity_planner)/launch/behavior_velocity_planner.launch.xml">
  </include>

</launch>
